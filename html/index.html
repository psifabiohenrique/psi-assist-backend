<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gravador de Áudio Pro</title>
    <!-- Tailwind CSS para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
  <body class="bg-gray-900 text-white">
    <div class="min-h-screen w-full flex flex-col items-center justify-center p-4 bg-gradient-to-br from-gray-900 to-slate-800">
      <div class="w-full max-w-md">

        <!-- Tela Inicial (Idle) -->
        <div id="idle-view">
          <div class="w-full flex flex-col items-center gap-6 p-8 bg-gray-800 rounded-lg shadow-2xl">
            <h2 class="text-3xl font-bold text-center">Gravador de Áudio</h2>
            <p class="text-gray-400 text-center">Selecione suas fontes de áudio e comece a gravar.</p>
            
            <div class="w-full space-y-4">
              <!-- Seleção de Microfone -->
              <div class="flex items-center gap-4 p-4 bg-gray-700 rounded-md">
                <label for="includeMic" class="flex-grow flex items-center gap-3 cursor-pointer">
                  <svg id="mic-icon-idle" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-cyan-400"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line></svg>
                  <span class="font-semibold">Áudio do Microfone</span>
                </label>
                <input type="checkbox" id="includeMic" checked class="form-checkbox h-5 w-5 text-cyan-500 bg-gray-800 border-gray-600 rounded focus:ring-cyan-600" />
              </div>

              <div id="mic-selection-container" class="pl-8">
                <select id="mic-select" class="w-full p-2 bg-gray-900 border border-gray-600 rounded-md focus:ring-cyan-500 focus:border-cyan-500">
                  <!-- Opções de microfone serão inseridas aqui via JS -->
                </select>
              </div>
              
              <!-- Seleção de Áudio do Sistema -->
              <div class="flex items-center gap-4 p-4 bg-gray-700 rounded-md">
                <label for="includeSystem" class="flex-grow flex items-center gap-3 cursor-pointer">
                  <svg id="system-icon-idle" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-gray-400"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                  <span class="font-semibold">Áudio do Sistema</span>
                </label>
                <input type="checkbox" id="includeSystem" class="form-checkbox h-5 w-5 text-cyan-500 bg-gray-800 border-gray-600 rounded focus:ring-cyan-600" />
              </div>
            </div>

            <button id="start-btn" class="mt-4 w-full px-8 py-4 bg-cyan-600 hover:bg-cyan-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg font-bold text-lg transition-colors">
              Iniciar Gravação
            </button>
          </div>
        </div>

        <!-- Tela de Gravação -->
        <div id="recording-view" class="hidden">
           <div class="w-full flex flex-col items-center gap-6">
            <div id="timer" class="text-6xl font-mono text-cyan-300 tracking-wider">00:00</div>
            <div class="relative w-full h-2 bg-gray-700 rounded-full overflow-hidden">
                <div class="absolute top-0 left-0 h-full bg-cyan-400 animate-pulse rounded-full" style="width: 100%;"></div>
            </div>
            <p class="text-lg text-gray-300">Gravando...</p>
            <div class="flex gap-4 mt-4">
              <button id="stop-btn" class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-full font-bold flex items-center gap-2 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><rect x="6" y="6" width="12" height="12"></rect></svg>
                Finalizar
              </button>
              <button id="cancel-btn" class="px-6 py-3 bg-red-600 hover:bg-red-700 rounded-full font-bold flex items-center gap-2 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                Cancelar
              </button>
            </div>
          </div>
        </div>

        <!-- Tela de Processamento -->
        <div id="processing-view" class="hidden">
          <div class="flex flex-col items-center gap-4 p-8">
            <div class="w-12 h-12 border-4 border-t-cyan-400 border-gray-600 rounded-full animate-spin"></div>
            <h2 class="text-xl font-bold text-cyan-300">Processando Áudio...</h2>
            <p id="processing-format-text" class="text-center text-gray-400">Finalizando sua gravação.</p>
          </div>
        </div>

        <!-- Tela Finalizada -->
        <div id="finished-view" class="hidden">
           <div class="w-full flex flex-col items-center gap-6 p-6 bg-gray-800 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold text-green-400">Gravação Concluída!</h2>
            
            <div class="w-full flex items-center gap-4 p-3 bg-gray-700 rounded-lg">
              <audio id="audio-player" preload="auto"></audio>
              <button id="play-pause-btn" class="p-2 bg-cyan-600 hover:bg-cyan-700 rounded-full">
                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 hidden"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
              </button>
              <div class="w-full bg-gray-600 rounded-full h-2.5">
                  <div id="progress-bar" class="bg-cyan-400 h-2.5 rounded-full" style="width: 0%"></div>
              </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 w-full mt-4">
              <a id="download-link" href="#" download="recording.ogg" class="w-full text-center px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-md font-bold flex items-center justify-center gap-2 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                Baixar <span id="download-format-text"></span>
              </a>
              <button id="record-again-btn" class="w-full px-6 py-3 bg-gray-600 hover:bg-gray-700 rounded-md font-bold transition-colors">
                Gravar Novamente
              </button>
            </div>
          </div>
        </div>
        
        <!-- Tela de Erro -->
        <div id="error-view" class="hidden">
           <div class="flex flex-col items-center gap-4 p-8 bg-red-900/50 rounded-lg">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 text-red-400"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <h2 class="text-xl font-bold text-red-300">Ocorreu um Erro</h2>
            <p id="error-message" class="text-center text-red-200">Mensagem de erro aqui.</p>
            <button id="try-again-btn" class="mt-4 px-6 py-2 bg-red-600 hover:bg-red-700 rounded-md font-semibold transition-colors">
              Tentar Novamente
            </button>
          </div>
        </div>

      </div>
    </div>
    <script type="module" src="/index.js"></script>
  </body>
</html>